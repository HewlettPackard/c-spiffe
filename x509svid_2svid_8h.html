<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C-SPIFFE Library: include/c-spiffe/svid/x509svid/svid.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">C-SPIFFE Library
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">C-SPIFFE Library for C extension for Spiffe platform.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_627fe8ff3a8667247b3daef3c2772854.html">c-spiffe</a></li><li class="navelem"><a class="el" href="dir_5b8130df6cf8d0bac7e96066cdfeb0ff.html">svid</a></li><li class="navelem"><a class="el" href="dir_74625fcadff6d487d6311ebdb091a652.html">x509svid</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">svid.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="id_8h_source.html">c-spiffe/spiffeid/id.h</a>&quot;</code><br />
<code>#include &lt;openssl/evp.h&gt;</code><br />
<code>#include &lt;openssl/x509.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for svid.h:</div>
<div class="dyncontent">
<div class="center"><img src="x509svid_2svid_8h__incl.png" border="0" usemap="#ainclude_2c-spiffe_2svid_2x509svid_2svid_8h" alt=""/></div>
<map name="ainclude_2c-spiffe_2svid_2x509svid_2svid_8h" id="ainclude_2c-spiffe_2svid_2x509svid_2svid_8h">
<area shape="rect" title=" " alt="" coords="382,5,519,47"/>
<area shape="rect" href="id_8h.html" title=" " alt="" coords="215,95,348,121"/>
<area shape="rect" title=" " alt="" coords="430,244,533,271"/>
<area shape="rect" title=" " alt="" coords="489,95,597,121"/>
<area shape="rect" href="utils_2util_8h.html" title=" " alt="" coords="260,169,383,196"/>
<area shape="rect" title=" " alt="" coords="5,244,80,271"/>
<area shape="rect" title=" " alt="" coords="133,169,235,196"/>
<area shape="rect" href="stb__ds_8h.html" title=" " alt="" coords="105,244,250,271"/>
<area shape="rect" href="error_8h.html" title=" " alt="" coords="274,244,406,271"/>
<area shape="rect" title=" " alt="" coords="225,319,293,345"/>
<area shape="rect" title=" " alt="" coords="49,319,113,345"/>
<area shape="rect" title=" " alt="" coords="138,319,201,345"/>
<area shape="rect" title=" " alt="" coords="317,319,379,345"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="x509svid_2svid_8h__dep__incl.png" border="0" usemap="#ainclude_2c-spiffe_2svid_2x509svid_2svid_8hdep" alt=""/></div>
<map name="ainclude_2c-spiffe_2svid_2x509svid_2svid_8hdep" id="ainclude_2c-spiffe_2svid_2x509svid_2svid_8hdep">
<area shape="rect" title=" " alt="" coords="2419,5,2557,47"/>
<area shape="rect" href="svid_2x509svid_2source_8h.html" title=" " alt="" coords="413,452,550,493"/>
<area shape="rect" href="x509svid_8h.html" title=" " alt="" coords="63,541,201,583"/>
<area shape="rect" href="client_8h.html" title=" " alt="" coords="2345,184,2511,225"/>
<area shape="rect" href="x509source_8h.html" title=" " alt="" coords="1615,363,1780,404"/>
<area shape="rect" href="check__x509source_8c.html" title=" " alt="" coords="1836,452,1983,493"/>
<area shape="rect" href="client_8cc.html" title=" " alt="" coords="3367,281,3494,307"/>
<area shape="rect" href="check__client_8cc.html" title=" " alt="" coords="3519,273,3665,315"/>
<area shape="rect" href="x509context_8h.html" title=" " alt="" coords="2124,95,2289,136"/>
<area shape="rect" href="peerid_8c.html" title=" " alt="" coords="2637,102,2753,129"/>
<area shape="rect" href="x509svid_2svid_8c.html" title=" " alt="" coords="2777,102,2916,129"/>
<area shape="rect" href="x509svid_2tests_2check__svid_8c.html" title=" " alt="" coords="2941,95,3075,136"/>
<area shape="rect" href="verify_8c.html" title=" " alt="" coords="3100,102,3247,129"/>
<area shape="rect" href="mode_8h.html" title=" " alt="" coords="626,541,785,583"/>
<area shape="rect" href="config_8h.html" title=" " alt="" coords="1450,541,1609,583"/>
<area shape="rect" href="svid_2x509svid_2source_8c.html" title=" " alt="" coords="396,549,551,575"/>
<area shape="rect" href="check__svidsource_8c.html" title=" " alt="" coords="225,541,372,583"/>
<area shape="rect" href="spiffe-http_2server_2main_8c.html" title=" " alt="" coords="196,742,335,783"/>
<area shape="rect" href="spiffe-jwt_2server_2main_8c.html" title=" " alt="" coords="991,742,1124,783"/>
<area shape="rect" href="spiffe-jwt-using-proxy_2server_2main_8c.html" title=" " alt="" coords="679,735,812,791"/>
<area shape="rect" href="spiffe-tls_2client_2main_8c.html" title=" " alt="" coords="1448,742,1579,783"/>
<area shape="rect" href="spiffe-tls_2server_2main_8c.html" title=" " alt="" coords="836,742,967,783"/>
<area shape="rect" href="dial_8h.html" title=" " alt="" coords="1114,638,1273,679"/>
<area shape="rect" href="spiffetls_8h.html" title=" " alt="" coords="495,742,654,783"/>
<area shape="rect" href="dial_8c.html" title=" " alt="" coords="1148,749,1249,776"/>
<area shape="rect" href="check__peerid_8c.html" title=" " alt="" coords="1285,742,1424,783"/>
<area shape="rect" href="listen_8h.html" title=" " alt="" coords="575,638,734,679"/>
<area shape="rect" href="listen_8c.html" title=" " alt="" coords="359,749,471,776"/>
<area shape="rect" href="mode_8c.html" title=" " alt="" coords="71,645,185,672"/>
<area shape="rect" href="check__mode_8c.html" title=" " alt="" coords="209,638,348,679"/>
<area shape="rect" href="server_8c.html" title=" " alt="" coords="510,928,639,955"/>
<area shape="rect" href="server_8h.html" title=" " alt="" coords="337,839,508,880"/>
<area shape="rect" href="server__example_8c.html" title=" " alt="" coords="301,928,485,955"/>
<area shape="rect" href="spiffe-http_2client_2main_8c.html" title=" " alt="" coords="2153,638,2292,679"/>
<area shape="rect" href="spiffe-jwt_2client_2main_8c.html" title=" " alt="" coords="2316,638,2449,679"/>
<area shape="rect" href="spiffe-jwt-using-proxy_2client_2main_8c.html" title=" " alt="" coords="1996,631,2129,687"/>
<area shape="rect" href="tlsconfig_8h.html" title=" " alt="" coords="1450,638,1609,679"/>
<area shape="rect" href="config_8c.html" title=" " alt="" coords="1633,638,1751,679"/>
<area shape="rect" href="check__config_8c.html" title=" " alt="" coords="1775,638,1921,679"/>
<area shape="rect" href="jwtwatcher_8h.html" title=" " alt="" coords="2345,273,2511,315"/>
<area shape="rect" href="workload_8h.html" title=" " alt="" coords="2345,452,2511,493"/>
<area shape="rect" href="jwtwatcher_8c.html" title=" " alt="" coords="2859,370,3010,397"/>
<area shape="rect" href="workload_2watcher_8h.html" title=" " alt="" coords="2004,273,2169,315"/>
<area shape="rect" href="workload_2watcher_8c.html" title=" " alt="" coords="2186,459,2321,486"/>
<area shape="rect" href="c__client__example_8c.html" title=" " alt="" coords="2535,281,2723,307"/>
<area shape="rect" href="c__client__example__bundle_8c.html" title=" " alt="" coords="2748,273,2927,315"/>
<area shape="rect" href="c__client__example__validate_8c.html" title=" " alt="" coords="2951,273,3129,315"/>
<area shape="rect" href="cpp__client__example_8cc.html" title=" " alt="" coords="3154,273,3291,315"/>
<area shape="rect" href="x509source_8c.html" title=" " alt="" coords="2007,459,2161,486"/>
<area shape="rect" href="bundle_2x509bundle_2source_8h.html" title=" " alt="" coords="843,452,994,493"/>
</map>
</div>
</div>
<p><a href="x509svid_2svid_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a26f3e732cf1ac265d04f6acadc91f0c4"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structx509svid__SVID.html">x509svid_SVID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a26f3e732cf1ac265d04f6acadc91f0c4">x509svid_SVID</a></td></tr>
<tr class="separator:a26f3e732cf1ac265d04f6acadc91f0c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a08ea0aeb3b19614ed65d2c34239b698e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a08ea0aeb3b19614ed65d2c34239b698e">x509svid_Load</a> (const char *certfile, const char *keyfile, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:a08ea0aeb3b19614ed65d2c34239b698e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0327f55d0ce873943dcd4b27eff5631a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a0327f55d0ce873943dcd4b27eff5631a">x509svid_Parse</a> (const <a class="el" href="utils_2util_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *certbytes, const <a class="el" href="utils_2util_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *keybytes, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:a0327f55d0ce873943dcd4b27eff5631a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96574cd2c7c3e0b5af2e0319096aa651"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a96574cd2c7c3e0b5af2e0319096aa651">x509svid_ParseRaw</a> (const <a class="el" href="utils_2util_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *certbytes, const size_t certlen, const <a class="el" href="utils_2util_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *keybytes, const size_t keylen, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:a96574cd2c7c3e0b5af2e0319096aa651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff4b0f5b2fc1d905fa383f6a4e7670b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#aff4b0f5b2fc1d905fa383f6a4e7670b8">x509svid_newSVID</a> (X509 **<a class="el" href="check__x509source_8c.html#a86cc65f14198e068d60b43bcf233a074">certs</a>, EVP_PKEY *pkey, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:aff4b0f5b2fc1d905fa383f6a4e7670b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb22b1aca190a0adc6d45c98ebbd9b79"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structspiffeid__ID.html">spiffeid_ID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#abb22b1aca190a0adc6d45c98ebbd9b79">x509svid_validateCertificates</a> (X509 **<a class="el" href="check__x509source_8c.html#a86cc65f14198e068d60b43bcf233a074">certs</a>, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:abb22b1aca190a0adc6d45c98ebbd9b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6296356ca33ec01a0c3726c15d14775d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structspiffeid__ID.html">spiffeid_ID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a6296356ca33ec01a0c3726c15d14775d">x509svid_validateLeafCertificate</a> (X509 *cert, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:a6296356ca33ec01a0c3726c15d14775d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac64e73a4241e928e009af785b429d50d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#ac64e73a4241e928e009af785b429d50d">x509svid_validateSigningCertificates</a> (X509 **<a class="el" href="check__x509source_8c.html#a86cc65f14198e068d60b43bcf233a074">certs</a>, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:ac64e73a4241e928e009af785b429d50d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac780ee789eef18d6d42616d1cd7bac83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#ac780ee789eef18d6d42616d1cd7bac83">x509svid_validateKeyUsage</a> (X509 *cert, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:ac780ee789eef18d6d42616d1cd7bac83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14454e8a13a1a67fc860bf0dd2db88de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a14454e8a13a1a67fc860bf0dd2db88de">x509svid_SVID_GetX509SVID</a> (<a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> *<a class="el" href="check__jwtsource_8c.html#a7dc8f87a6d2bcbcb06f9f58b42155676">svid</a>, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:a14454e8a13a1a67fc860bf0dd2db88de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0750132b7a9b78680449a8db1749af01"><td class="memItemLeft" align="right" valign="top">EVP_PKEY *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a0750132b7a9b78680449a8db1749af01">x509svid_validatePrivateKey</a> (EVP_PKEY *priv_key, X509 *cert, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:a0750132b7a9b78680449a8db1749af01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b54ccd57184989d06e15d2bdc654306"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a9b54ccd57184989d06e15d2bdc654306">x509svid_keyMatches</a> (EVP_PKEY *priv_key, EVP_PKEY *pub_key, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:a9b54ccd57184989d06e15d2bdc654306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86bb0aab37f97488bf2dadfbd672e58f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a86bb0aab37f97488bf2dadfbd672e58f">x509svid_SVID_Free</a> (<a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> *<a class="el" href="check__jwtsource_8c.html#a7dc8f87a6d2bcbcb06f9f58b42155676">svid</a>)</td></tr>
<tr class="separator:a86bb0aab37f97488bf2dadfbd672e58f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65d6f203d0eeacd144e974e8d2616854"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a65d6f203d0eeacd144e974e8d2616854">x509svid_SVID_GetDefaultX509SVID</a> (<a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> **<a class="el" href="check__x509source_8c.html#afddf11b35962192583095189618f0562">svids</a>)</td></tr>
<tr class="separator:a65d6f203d0eeacd144e974e8d2616854"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a71833432762f29b35b7c0807a65195"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structspiffeid__ID.html">spiffeid_ID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="x509svid_2svid_8h.html#a3a71833432762f29b35b7c0807a65195">x509svid_IDFromCert</a> (X509 *cert, <a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *<a class="el" href="check__endpoint_8c.html#aac2cb6376062ef4d6f16d129f52ea9e4">err</a>)</td></tr>
<tr class="separator:a3a71833432762f29b35b7c0807a65195"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a26f3e732cf1ac265d04f6acadc91f0c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26f3e732cf1ac265d04f6acadc91f0c4">&#9670;&nbsp;</a></span>x509svid_SVID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> <a class="el" href="structx509svid__SVID.html">x509svid_SVID</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>X509-SVID object </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3a71833432762f29b35b7c0807a65195"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a71833432762f29b35b7c0807a65195">&#9670;&nbsp;</a></span>x509svid_IDFromCert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structspiffeid__ID.html">spiffeid_ID</a> x509svid_IDFromCert </td>
          <td>(</td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extracts the SPIFFE ID from the URI SAN of the provided certificate. It will return an an error if the certificate does not have exactly one URI SAN with a well-formed SPIFFE ID.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cert</td><td>[in] X.509 certificate object pointer. </td></tr>
    <tr><td class="paramname">err</td><td>[out] Variable to get information in the event of error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SPIFFE ID of the leaf certificate. </dd></dl>

</div>
</div>
<a id="a9b54ccd57184989d06e15d2bdc654306"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b54ccd57184989d06e15d2bdc654306">&#9670;&nbsp;</a></span>x509svid_keyMatches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool x509svid_keyMatches </td>
          <td>(</td>
          <td class="paramtype">EVP_PKEY *&#160;</td>
          <td class="paramname"><em>priv_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">EVP_PKEY *&#160;</td>
          <td class="paramname"><em>pub_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a08ea0aeb3b19614ed65d2c34239b698e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08ea0aeb3b19614ed65d2c34239b698e">&#9670;&nbsp;</a></span>x509svid_Load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a>* x509svid_Load </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>certfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>keyfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load loads the X509-SVID from PEM encoded files on disk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">certfile</td><td>[in] Certificate file path. </td></tr>
    <tr><td class="paramname">keyfile</td><td>[in] Key file path. </td></tr>
    <tr><td class="paramname">err</td><td>[out] Variable to get information in the event of error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Parsed X509-SVID object pointer. Must be freed using x509svid_SVID_Free function.</dd></dl>
<p>(C) Copyright 2020-2021 Hewlett Packard Enterprise Development LP</p>
<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. </p>

</div>
</div>
<a id="aff4b0f5b2fc1d905fa383f6a4e7670b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff4b0f5b2fc1d905fa383f6a4e7670b8">&#9670;&nbsp;</a></span>x509svid_newSVID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a>* x509svid_newSVID </td>
          <td>(</td>
          <td class="paramtype">X509 **&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">EVP_PKEY *&#160;</td>
          <td class="paramname"><em>pkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Marshals the X509-SVID and returns PEM encoded blocks for the SVID and private key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">certs</td><td>[in] stb array of X.509 certificate object pointers. </td></tr>
    <tr><td class="paramname">pkey</td><td>[in] private key object pointer. </td></tr>
    <tr><td class="paramname">err</td><td>[out] Variable to get information in the event of error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Parsed X509-SVID object pointer. Must be freed using x509svid_SVID_Free function. </dd></dl>

</div>
</div>
<a id="a0327f55d0ce873943dcd4b27eff5631a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0327f55d0ce873943dcd4b27eff5631a">&#9670;&nbsp;</a></span>x509svid_Parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a>* x509svid_Parse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="utils_2util_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>certbytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="utils_2util_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>keybytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parses the X509-SVID from PEM blocks containing certificate and key bytes. The certificate must be one or more PEM blocks with ASN.1 DER. The key must be a PEM block with PKCS#8 ASN.1 DER.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">certbytes</td><td>[in] stb array with certificate bytes. </td></tr>
    <tr><td class="paramname">keybytes</td><td>[in] stb array with private key bytes. </td></tr>
    <tr><td class="paramname">err</td><td>[out] Variable to get information in the event of error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Parsed X509-SVID object pointer. Must be freed using x509svid_SVID_Free function. </dd></dl>

</div>
</div>
<a id="a96574cd2c7c3e0b5af2e0319096aa651"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96574cd2c7c3e0b5af2e0319096aa651">&#9670;&nbsp;</a></span>x509svid_ParseRaw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a>* x509svid_ParseRaw </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="utils_2util_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>certbytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>certlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="utils_2util_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>keybytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ParseRaw parses the X509-SVID from certificate and key bytes. The certificate must be ASN.1 DER (concatenated with no intermediate padding if there are more than one certificate). The key must be a PKCS#8 ASN.1 DER.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">certbytes</td><td>[in] array with certificate bytes. </td></tr>
    <tr><td class="paramname">certlen</td><td>[in] length of certificate array in bytes. </td></tr>
    <tr><td class="paramname">keybytes</td><td>[in] array with private key bytes. </td></tr>
    <tr><td class="paramname">keylen</td><td>[in] length of private key array in bytes. </td></tr>
    <tr><td class="paramname">err</td><td>[out] Variable to get information in the event of error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Parsed X509-SVID object pointer. Must be freed using x509svid_SVID_Free function. </dd></dl>

</div>
</div>
<a id="a86bb0aab37f97488bf2dadfbd672e58f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86bb0aab37f97488bf2dadfbd672e58f">&#9670;&nbsp;</a></span>x509svid_SVID_Free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void x509svid_SVID_Free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> *&#160;</td>
          <td class="paramname"><em>svid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees a X509-SVID object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">svid</td><td>[in] SVID object pointer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a65d6f203d0eeacd144e974e8d2616854"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65d6f203d0eeacd144e974e8d2616854">&#9670;&nbsp;</a></span>x509svid_SVID_GetDefaultX509SVID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a>* x509svid_SVID_GetDefaultX509SVID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> **&#160;</td>
          <td class="paramname"><em>svids</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the default SVID from a list of SVIDS.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">svids</td><td>[in] SVID object pointer array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>First SVID object pointer in array. </dd></dl>

</div>
</div>
<a id="a14454e8a13a1a67fc860bf0dd2db88de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14454e8a13a1a67fc860bf0dd2db88de">&#9670;&nbsp;</a></span>x509svid_SVID_GetX509SVID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a>* x509svid_SVID_GetX509SVID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structx509svid__SVID.html">x509svid_SVID</a> *&#160;</td>
          <td class="paramname"><em>svid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abb22b1aca190a0adc6d45c98ebbd9b79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb22b1aca190a0adc6d45c98ebbd9b79">&#9670;&nbsp;</a></span>x509svid_validateCertificates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structspiffeid__ID.html">spiffeid_ID</a> x509svid_validateCertificates </td>
          <td>(</td>
          <td class="paramtype">X509 **&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Validates the slice of certificates constitutes a valid SVID chain according to the spiffe standard and returns the spiffe id of the leaf certificate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">certs</td><td>[in] stb array of X.509 certificate object pointers. </td></tr>
    <tr><td class="paramname">err</td><td>[out] Variable to get information in the event of error. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Leaf SPIFFE ID. </dd></dl>

</div>
</div>
<a id="ac780ee789eef18d6d42616d1cd7bac83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac780ee789eef18d6d42616d1cd7bac83">&#9670;&nbsp;</a></span>x509svid_validateKeyUsage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void x509svid_validateKeyUsage </td>
          <td>(</td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6296356ca33ec01a0c3726c15d14775d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6296356ca33ec01a0c3726c15d14775d">&#9670;&nbsp;</a></span>x509svid_validateLeafCertificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structspiffeid__ID.html">spiffeid_ID</a> x509svid_validateLeafCertificate </td>
          <td>(</td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0750132b7a9b78680449a8db1749af01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0750132b7a9b78680449a8db1749af01">&#9670;&nbsp;</a></span>x509svid_validatePrivateKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EVP_PKEY* x509svid_validatePrivateKey </td>
          <td>(</td>
          <td class="paramtype">EVP_PKEY *&#160;</td>
          <td class="paramname"><em>priv_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac64e73a4241e928e009af785b429d50d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac64e73a4241e928e009af785b429d50d">&#9670;&nbsp;</a></span>x509svid_validateSigningCertificates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void x509svid_validateSigningCertificates </td>
          <td>(</td>
          <td class="paramtype">X509 **&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#a5362d878a3b55147d5cfd29820512556">err_t</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
